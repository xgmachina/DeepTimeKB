---
title: "DeepTimeKB Examples"
Author: "Chao Ma (chao@uidaho.edu), Xiaogang Ma (max@uidaho.edu)"
Date: "2020-12-16"
output:
  html_document: default
  pdf_document: default
---
Date: 2020-12-16

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Introduction
This document generated by R Markdown shows how to install the _DeepTimeKB_ package from GitHub and run examples.  _DeepTimeKB_ is an R package that queries knowledge and do knowledge inferences from the deep-time knowledge base.

Environment  
  - R version: 4.0.3  
  - RStudio: 1.2.5033   
  - Platform: Mac OS 10.15.3  
  
Authors:
Chao Ma (chao@uidaho.edu), Xiaogang Ma (max@uidaho.edu)
   
***
### Install and load necessary packages
Install _devtools_ package
```{r results='hide'}
install.packages("devtools", repos = "https://cloud.r-project.org")
```

Install _DeepTimeKB_ package from GitHub
```{r message=FALSE, results='hide'}
devtools::install_github("xgmachina/DeepTimeKB/DeeptTimeKB_RLib", force = T)
```
Load _DeepTimeKB_
```{r message=FALSE}
library(DeepTimeKB)
```

### Examples
#### 1. List available scheme in deep-time knowledge base
For a geoscientist, an intuitive first question using the _DeepTimeKB_ package is to know what are the available vocabularies of iGTS and rGTS in the knowledge base. This information can be obtained by running function _gts.listRegion_. It returns both the identifier and the literal name of all vocabulary schemes in the knowledge base.
```{r}
gts.listRegion()
```

#### 2. List all geologic time concepts in the level of Era from the international geologic time scale
After choosing a vocabulary scheme, the function _gts.list_ can be used to list all geologic time concepts of a certain level in that vocabulary. Two parameters need to be specified in this function. The parameter “region” controls the scheme, while “level” determines the concept level (i.e. Eon, Era, Period, Epoch, or Age).
```{r}
gts.list(region = "international", level = "Era")
```

#### 3. Extract properties of Mata Epoch from the regional geologic time scale of New Zealand
The properties associated with a certain geologic concept can be extracted by running the function _gts_.
```{r}
gts(geoConcept = "Mata")
```

#### 4. Find the levels of geologic time concpets of "Mata" and "Jurassic"
In some cases the level of a specific geologic time concept is needed for further analysis.  The function _gts.level_ can be used, in which the input is the literal name of a geologic time concept, and the output is the vocabulary scheme and level of the concept.
```{r}
gts.level(geoConcept = "Mata")
gts.level(geoConcept = "Jurassic")
```

#### 5. Query all geologic time concepts that contain the 50 Ma time point 
The function _gts.point_ answers the question about which geologic time concepts contain a specific time point in Earth history. 
```{r}
gts.point(time = 50)
```

#### 6. Retrieve attributes of "Wordian Age"
The function _gts.range_ can extract start and end time, vocabulary scheme, and duration of a specific geologic time concept. In this function a parameter “iscVersion” can be set for querying the geologic time concept from a specific version of ISC in the iGTS. The parameter “region” can be set for retrieving the concept from a specific vocabulary scheme in the rGTS.
```{r}
gts.range(geoConcept = "Wordian") # Not specifying the region of the concept
```
```{r}
gts.range(geoConcept = "Wordian", region = "North America") # Specifying the region of the concept

```

#### 7. Query geologic time concepts between 10 and 15 Ma
The function _gts.within_ is for querying geologic time concepts inside a specific duration of time of which the start and end time are set by two parameters “geotime1” and “geotime2”. 
```{r}
gts.within(geotime1 = 10, geotime2 = 15)
```

#### 8. Find broader and narrower concepts of “Mata Epoch”
The function _gts.hierarchy_ can return the broader and narrower concepts of an input concept, thus to show the hierarchical structure in the GTS. 
```{r}
gts.hierarchy(geoConcept = "Mata")
```

#### 9. Query GSSP data from the 2018-07 International Stratigraphic Chart in the knowledge graph
The function _gts.gssp_ is created to query the GSSP information from the knowledge graph. All GSSP information can be obtained by running _gts.gssp()_, and the parameter “iscVersion” can be set to query the information only from a certain version of ISC in the iGTS. The returned information includes vocabulary scheme, GSSP name, longitude, and latitude.
```{r}
gts.gssp(iscVersion = "2018-07")
```

#### 10. Plot the GSSP data from the 2018-07 International Stratigraphic Chart in the knowledge graph on a world map
The function _gssp.map_ can visualize the GSSP information by plotting all GSSPs on a world map, in which the parameter “iscVersion” can be used to set the version of ISC in the iGTS.
```{r}
gssp.map(iscVersion = "2018-07")
```

#### 11. Knowledge inference of temporal topology between two geologic time concepts
In the _DeeptimeKB_ package, the function _gts.topo_ is created to implement the temporal topology. The input of this function is two geologic time concepts, and each is specified by two parameters: 1) concept name and 2) region in the rGTS or version of ISC in the iGTS.
```{r}
gts.topo(geoConcept1 = "Jurassic", region1 = "international", iscVersion1 = "2018-07", geoConcept2 = "Mesozoic", region2 = "international", iscVersion2 = "2018-07") # two concepts from the same scheme

```
```{r}
gts.topo(geoConcept1 = "Jurassic", region1 = "international", iscVersion1 = "2018-07", geoConcept2 = "Mata", region2 = "New Zealand") # two concepts from two different schemes
```
